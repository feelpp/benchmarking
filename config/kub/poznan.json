{
    "executable": "feelpp_kub_cem",
    "output_directory": "{{machine.output_app_dir}}/javier_test/kub",
    "use_case_name": "poznan",
    "timeout":"0-0:15:0",
    "resources":{
        "tasks":"{{parameters.resources.tasks.value}}",
        "exclusive_access":"{{parameters.resources.exclusive_access.value}}"
    },
    "platforms": {
        "apptainer":{
            "image": {
                "remote":"oras://ghcr.io/feelpp/ktirio-urban-building:master-sif",
                "name":"{{machine.containers.apptainer.image_base_dir}}/kub.sif",
                "pull_command": "{{machine.containers.apptainer.executable}} pull -F {{platforms.apptainer.image.name}} {{platforms.apptainer.image.remote}}"
            },
            "input_dir":"/input_data",
            "options": [
                "--home {{machine.output_app_dir}}",
                "--bind {{machine.input_dataset_base_dir}}:{{platforms.apptainer.input_dir}}",
                "--env OMP_NUM_THREADS=1"
            ],
            "append_app_option":[]
        },
        "builtin":{
            "input_dir":"{{machine.input_dataset_base_dir}}",
            "append_app_option":[]
        }
    },
    "input_file_dependencies":{
        "case_cfg":"kub/cfg/Poznan.cfg"
    },
    "options": [
        "--config-file {{platforms.{{machine.platform}}.input_dir}}/{{input_file_dependencies.case_cfg}}",
        "--cem.database.directory {{output_directory}}/{{instance}}/{{use_case_name}}",
        "--directory {{output_directory}}/{{instance}}/{{use_case_name}}"
    ],
    "scalability": {
        "directory": "{{output_directory}}/{{instance}}/{{use_case_name}}/cem/",
        "stages": [
            {
                "name":"",
                "filepath": "instances/np_{{parameters.resources.tasks.value}}/logs/timers.json",
                "format": "json",
                "variables_path":["*.timeElapsed.max","execute.subtimers.*.subtimers.*.timeElapsed.max","execute.subtimers.*.timeElapsed.max"]
            },
            {
                "name":"",
                "filepath": "logs/timers.json",
                "format": "json",
                "variables_path":["*.timeElapsed.max","*.subtimers.*.subtimers.*.timeElapsed.max"]
            }
        ]
    },
    "sanity": {
        "success": ["[ Stopping Feel++ ]"],
        "error": ["Error"]
    },
    "parameters": [
        {
            "name": "resources",
            "sequence": [
                {"tasks":32, "exclusive_access":true},
                {"tasks":64, "exclusive_access":true},
                {"tasks":128, "exclusive_access":true},
                {"tasks":256, "exclusive_access":true},
                {"tasks":384, "exclusive_access":true},
                {"tasks":512, "exclusive_access":true}
            ]
        }
    ]
}